<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Some reading on IRIs and IDNs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20Some%20reading%20on%20IRIs%20and%20IDNs&In-Reply-To=%3C20201210054501.GE24194%40brevard.conman.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003945.html">
   <LINK REL="Next"  HREF="003948.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Some reading on IRIs and IDNs</H1>
    <B>Sean Conner</B> 
    <A HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20Some%20reading%20on%20IRIs%20and%20IDNs&In-Reply-To=%3C20201210054501.GE24194%40brevard.conman.org%3E"
       TITLE="Some reading on IRIs and IDNs">sean at conman.org
       </A><BR>
    <I>Thu Dec 10 05:45:01 GMT 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003945.html">Some reading on IRIs and IDNs
</A></li>
        <LI>Next message (by thread): <A HREF="003948.html">Some reading on IRIs and IDNs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3946">[ date ]</a>
              <a href="thread.html#3946">[ thread ]</a>
              <a href="subject.html#3946">[ subject ]</a>
              <a href="author.html#3946">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It was thus said that the Great Michael Lazar once stated:
&gt;<i> I've been following along with my own software in the background.
</I>
  Thank you.  Without an implementation it is difficult to see where the
landmines are.  So, with that said ...

&gt;<i> First of all, my domain registrar won't even let me put unicode characters
</I>&gt;<i> in an A record without automatically converting them to punycode for me.
</I>&gt;<i> 
</I>&gt;<i> caf&#233;.mozz.us -&gt; xn--caf-dma.mozz.us
</I>
  Okay.

&gt;<i> Next, my naive python test client just kind of works as-is [0][1]. It will
</I>&gt;<i> convert unicode DNS names to punycode under the hood before doing the lookup.
</I>&gt;<i> Any unicode in the URL (IRI?) is left alone because.. why would a
</I>&gt;<i> client ever muck
</I>&gt;<i> around with the URL that the user gives them? That sounds like a bad idea to
</I>&gt;<i> me.
</I>
  That's debatable.  The percent encoding doesn't change the meaning, just
the &quot;envelope&quot; so-to-speak.  

&gt;<i> My server (running jetforce) also works as-is. All I had to do was add an entry
</I>&gt;<i> for &quot;caf&#233;.mozz.us&quot; as a recognized hostname, and there you go.
</I>
  Okay, about that.  I modified my own stupid-simple client to support IRIs
and to convert the hostname via punycode (finally!).  The code changes in
the client weren't that large (once I got the punycode module written, it
was one line to switch from URI parsing to IRI parsing, one line to add the
punycode module, and one line modified to punycode the host when making a
connection) but I'm encountering an issue.  If I use:

	<A HREF="gemini://caf&#233;.mozz.us/files/&#119995;&#119990;&#120003;&#119992;&#120014;.txt">gemini://caf&#233;.mozz.us/files/&#119995;&#119990;&#120003;&#119992;&#120014;.txt</A>

(and send that as the request) It works, and I get the file.  But when I go
to:

	<A HREF="gemini://xn--caf-dma.mozz.us/files/%F0%9D%92%BB%F0%9D%92%B6%F0%9D%93%83%F0%9D%92%B8%F0%9D%93%8E.txt">gemini://xn--caf-dma.mozz.us/files/%F0%9D%92%BB%F0%9D%92%B6%F0%9D%93%83%F0%9D%92%B8%F0%9D%93%8E.txt</A>

(and send that as the request) I get an error 53 (no proxy allowed).  When I
go to:

	<A HREF="gemini://caf&#233;.mozz.us/files/%F0%9D%92%BB%F0%9D%92%B6%F0%9D%93%83%F0%9D%92%B8%F0%9D%93%8E.txt">gemini://caf&#233;.mozz.us/files/%F0%9D%92%BB%F0%9D%92%B6%F0%9D%93%83%F0%9D%92%B8%F0%9D%93%8E.txt</A>

(and send that as the request) it works as well.  I would expect the second
example to work along with the first and third examples. They all reference
the same resource in the same server.

  Another issue that I've thought of, the length of each request---the first
is 53 bytes, the second is 99 bytes and the third is 93 bytes.  This *could*
be an issue with respect to the the overall limit of 1024 bytes for a
request.

  As far as servers go, GLV-1.12556 still uses the URL parser, and would
choke on an IRI being given as a request (since it expects non-ASCII
characters to be encoded per RFC-3986).  That would be an easy fix for me
(just switch to the IRI parser) but allowing IRIs would be an actual change
to the protocol.  I'm just saying.

&gt;<i> Does this mean my server is already compliant? What else should I try?
</I>
  Perhaps allow &quot;xn--caf-dma.mozz.us&quot; as a hostname?

  -spc

&gt;<i> [0] <A HREF="https://github.com/michael-lazar/jetforce/blob/master/jetforce_client.py">https://github.com/michael-lazar/jetforce/blob/master/jetforce_client.py</A>
</I>&gt;<i> [1] It's nice to finally get a win for python after fighting with TLS
</I>&gt;<i> for so long
</I></PRE>









































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003945.html">Some reading on IRIs and IDNs
</A></li>
	<LI>Next message (by thread): <A HREF="003948.html">Some reading on IRIs and IDNs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3946">[ date ]</a>
              <a href="thread.html#3946">[ thread ]</a>
              <a href="subject.html#3946">[ subject ]</a>
              <a href="author.html#3946">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.orbitalfox.eu/listinfo/gemini">More information about the Gemini
mailing list</a><br>
</body></html>
