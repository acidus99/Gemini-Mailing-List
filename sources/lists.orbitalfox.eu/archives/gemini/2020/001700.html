<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> CSRF in Gemini
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20CSRF%20in%20Gemini&In-Reply-To=%3Cc612dd1d-8d81-625e-84eb-e4cc7f94fe33%40masterq32.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001733.html">
   <LINK REL="Next"  HREF="001720.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>CSRF in Gemini</H1>
    <B>Felix Quei&#223;ner</B> 
    <A HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20CSRF%20in%20Gemini&In-Reply-To=%3Cc612dd1d-8d81-625e-84eb-e4cc7f94fe33%40masterq32.de%3E"
       TITLE="CSRF in Gemini">felix at masterq32.de
       </A><BR>
    <I>Mon Jun 15 16:05:33 BST 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001733.html">CSRF in Gemini
</A></li>
        <LI>Next message (by thread): <A HREF="001720.html">CSRF in Gemini
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1700">[ date ]</a>
              <a href="thread.html#1700">[ thread ]</a>
              <a href="subject.html#1700">[ subject ]</a>
              <a href="author.html#1700">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey!

&gt;<i> I just wrote down a few thoughts about cross-site request forgery in Gemini:
</I>
Good read! I thought about that as well&#8230;

&gt;&gt;<i> CSRF protection via non-native nonces is ugly, can we do better than
</I>&gt;&gt;<i> the web?
</I>I think one solution would be to force clients to remove queries from
all URLs. It's not a really elegant solution and makes CGI stuff harder
to implement, but will prevent a lot of URL-fuckery. I'm also always
scared when clicking links in interactive things, because double
postings are really easy to achieve with the query appended to URLs.
Hitting refresh in your browser to see new posts? You create a new post
in the guestbook!

While writing this, i got the following idea (which seams reasonable to me):
Specify that a response to INPUT MUST be passed with a query-parameter
&quot;?input=&#8230;&quot; where &quot;&#8230;&quot; is the data from the user. The data is fully
urlencoded with all forbidden characters(space,?,=,&#8230;) replaced with
their percent-encoding.

Also specify that clients SHOULD remove the &quot;input&quot;-parameter between
redirects and in documents using the gemini-scheme.

This allows us to prevent passing accidential or malicious data via
redirects, but doesn't help against a spam-bot that targets a site
directly. It also makes client implementation a bit harder.

Regards
- xq
</PRE>






































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001733.html">CSRF in Gemini
</A></li>
	<LI>Next message (by thread): <A HREF="001720.html">CSRF in Gemini
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1700">[ date ]</a>
              <a href="thread.html#1700">[ thread ]</a>
              <a href="subject.html#1700">[ subject ]</a>
              <a href="author.html#1700">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.orbitalfox.eu/listinfo/gemini">More information about the Gemini
mailing list</a><br>
</body></html>
