<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Enhancing TOFU
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20Enhancing%20TOFU&In-Reply-To=%3C20210305181439.wtp6e4ccz7zdsvzj%40localhost%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005959.html">
   <LINK REL="Next"  HREF="006030.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Enhancing TOFU</H1>
    <B>mbays at sdf.org</B> 
    <A HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20Enhancing%20TOFU&In-Reply-To=%3C20210305181439.wtp6e4ccz7zdsvzj%40localhost%3E"
       TITLE="Enhancing TOFU">mbays at sdf.org
       </A><BR>
    <I>Fri Mar  5 18:14:39 GMT 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005959.html">Enhancing TOFU
</A></li>
        <LI>Next message (by thread): <A HREF="006030.html">[tech] signing when rotating (Was: Re: Enhancing TOFU)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5969">[ date ]</a>
              <a href="thread.html#5969">[ thread ]</a>
              <a href="subject.html#5969">[ subject ]</a>
              <a href="author.html#5969">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>* Friday, 2021-03-05 at 13:33 +0100 - <A HREF="https://lists.orbitalfox.eu/listinfo/gemini">nothien at uber.space</A> &lt;<A HREF="https://lists.orbitalfox.eu/listinfo/gemini">nothien at uber.space</A>&gt;:

&gt;<i>I think that people find TOFU controversial because it [...] prevents 
</I>&gt;<i>servers from ever being able to change certificates.
</I>
Yes, this is a real problem. Even with a long-lived certificate you will 
need to change it eventually to keep up with developments in 
cryptography.

But I think we can solve this neatly by using certificate chains. If you 
have a certificate which is trusted by many users and want to rotate to 
a new certificate, sign the new certificate with the old one (treating 
it as a CA) and have your server present the old certificate and the new 
one as a chain. Then users will be able to see that they should carry 
over their trust in the old certificate to the new one.

Clients should either warn the user about the change while providing 
enough information that the user can see what has happened, or could 
optionally automatically transfer trust to a cert signed by a previously 
trusted cert for the same domain (being careful about wildcards!).

Some clients already provide enough information, i.e. fingerprints for 
the old trusted cert and all certs in the new chain. But I see that not 
all do.

I tested the signing process, and it seems straightforward. Here's what 
I did, but please don't slavishly copy this; this is the result of a few 
minutes with man openssl-x509, and I may be missing some important steps 
(e.g. I ignored serial numbers, which I *think* makes sense, but maybe 
I'm missing something):
```
gemcert -server mydomain
openssl x509 -CA old.crt -CAkey old.key -in mydomain.crt -out signed.crt
cat signed.crt old.crt &gt; chain.crt
```
Now give chain.crt and mydomain.key to your server.
Here old.crt was also generated by gemcert.

Am I missing something, or does this make sense?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 195 bytes
Desc: not available
URL: &lt;<A HREF="https://lists.orbitalfox.eu/archives/gemini/attachments/20210305/6800469b/attachment.sig">https://lists.orbitalfox.eu/archives/gemini/attachments/20210305/6800469b/attachment.sig</A>&gt;
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005959.html">Enhancing TOFU
</A></li>
	<LI>Next message (by thread): <A HREF="006030.html">[tech] signing when rotating (Was: Re: Enhancing TOFU)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5969">[ date ]</a>
              <a href="thread.html#5969">[ thread ]</a>
              <a href="subject.html#5969">[ subject ]</a>
              <a href="author.html#5969">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.orbitalfox.eu/listinfo/gemini">More information about the Gemini
mailing list</a><br>
</body></html>
