<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [spec] What to do of fragments when there is a redirection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20%5Bspec%5D%20What%20to%20do%20of%20fragments%20when%20there%20is%20a%20redirection&In-Reply-To=%3C5FE27F33.1070705%40marmaladefoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004281.html">
   <LINK REL="Next"  HREF="004295.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[spec] What to do of fragments when there is a redirection</H1>
    <B>Luke Emmet</B> 
    <A HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20%5Bspec%5D%20What%20to%20do%20of%20fragments%20when%20there%20is%20a%20redirection&In-Reply-To=%3C5FE27F33.1070705%40marmaladefoo.com%3E"
       TITLE="[spec] What to do of fragments when there is a redirection">luke at marmaladefoo.com
       </A><BR>
    <I>Tue Dec 22 23:20:19 GMT 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004281.html">[spec] What to do of fragments when there is a redirection
</A></li>
        <LI>Next message (by thread): <A HREF="004295.html">[spec] What to do of fragments when there is a redirection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4291">[ date ]</a>
              <a href="thread.html#4291">[ thread ]</a>
              <a href="subject.html#4291">[ subject ]</a>
              <a href="author.html#4291">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On 22-Dec-2020 20:34, John Cowan wrote:
&gt;<i>
</I>&gt;<i>     Therefore, for HTTP, RFC 7231 has to describe in detail what the
</I>&gt;<i>     client (&quot;user agent&quot;, in HTTP parlance) has to do with
</I>&gt;<i>     fragments. Should we consider that &quot;in doubt, do as HTTP does?&quot;)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I think we should adopt the following RFC 7231 compatible rules.
</I>&gt;<i>
</I>&gt;<i> 0) The semantics of a fragment are defined solely by the media type of 
</I>&gt;<i> the resource and not by the rest of the URL.
</I>&gt;<i>
</I>&gt;<i> 1) Clients MUST NOT send a fragment to the server.  If the server 
</I>&gt;<i> needs to know the content of a fragment, it should be part of the path 
</I>&gt;<i> or the query string instead.  This was a firm HTTP rule until 
</I>&gt;<i> fragments beginning with ! were invented, and IMO should be a firm 
</I>&gt;<i> Gemini rule.
</I>&gt;<i>
</I>&gt;<i> 2) If the client gets a redirect containing a fragment, the client 
</I>&gt;<i> MUST apply this fragment when the redirected resource is 
</I>&gt;<i> retrieved, ignoring any original fragment.
</I>&gt;<i>
</I>&gt;<i> 3) If the original URL has a fragment and the redirect doesn't, the 
</I>&gt;<i> client MUST apply the original fragment when the redirected resource 
</I>&gt;<i> is retrieved.
</I>&gt;<i>
</I>&gt;<i> 4) Content authors MUST NOT put personally identifying information 
</I>&gt;<i> into fragments, as they can be transferred from one host to another by 
</I>&gt;<i> the operation of rule 3.
</I>
I agree with this - that they should be client side only, but can be 
part of a persistent URL.

The question that remains particularly, is what should be the semantics 
of the fragment for our most prevalent media type - text/gemini?

I would propose that the fragment should indicate an offset to one of 
the headers in the page - but we'd need to agree how they should be 
formulated.

Some Markdown engines seems to have an established convention of 
creating the fragment name based on the header text, suitably 
normalised, e.g.

# Here is a heading

would have the associated offset fragment: &quot;here-is-a-heading&quot;

this approach is somewhat robust to page edits

Another approach could be to use the line index e.g. endpoint#12 means 
the twelfth line in that page. This is more finegrained, but is a bit 
more fragile.

Then again, do we really have much of a need to do page-specific 
indexing for URLs? Most Gemini pages are quite simple and not too 
complicated. So maybe we just get by without the fragment?

  - Luke
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004281.html">[spec] What to do of fragments when there is a redirection
</A></li>
	<LI>Next message (by thread): <A HREF="004295.html">[spec] What to do of fragments when there is a redirection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4291">[ date ]</a>
              <a href="thread.html#4291">[ thread ]</a>
              <a href="subject.html#4291">[ subject ]</a>
              <a href="author.html#4291">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.orbitalfox.eu/listinfo/gemini">More information about the Gemini
mailing list</a><br>
</body></html>
