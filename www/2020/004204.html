<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Supporting TLS client certificate in PHP?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20Supporting%20TLS%20client%20certificate%20in%20PHP%3F&In-Reply-To=%3C871rfjd0ws.fsf%40omarpolo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004197.html">
   <LINK REL="Next"  HREF="004206.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Supporting TLS client certificate in PHP?</H1>
    <B>Omar Polo</B> 
    <A HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20Supporting%20TLS%20client%20certificate%20in%20PHP%3F&In-Reply-To=%3C871rfjd0ws.fsf%40omarpolo.com%3E"
       TITLE="Supporting TLS client certificate in PHP?">op at omarpolo.com
       </A><BR>
    <I>Mon Dec 21 08:21:55 GMT 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004197.html">Supporting TLS client certificate in PHP?
</A></li>
        <LI>Next message (by thread): <A HREF="004206.html">Supporting TLS client certificate in PHP?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4204">[ date ]</a>
              <a href="thread.html#4204">[ thread ]</a>
              <a href="subject.html#4204">[ subject ]</a>
              <a href="author.html#4204">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
C&#244;me Chilliet &lt;<A HREF="https://lists.orbitalfox.eu/listinfo/gemini">come at chilliet.eu</A>&gt; writes:
&gt;<i> [snip]
</I>&gt;<i> However, even if I was implementing this in C it is not clear to me how to request a client certificate without making it mandatory, is that what SSL_VERIFY_CLIENT_ONCE is for?
</I>&gt;<i> Are there Gemini servers in C with client certificate support of which I could read the code out there?
</I>&gt;<i>
</I>&gt;<i> C&#244;me
</I>
I've written my server[0] using LibreSSL (a fork of OpenSSL) and it
supports client certs.  The code is quite short (a bit more than 1k
lines) but the key points for your question are these two lines[1]:

	/* optionally accept client certs, but don't try to verify them */
	tls_config_verify_client_optional(conf);
	tls_config_insecure_noverifycert(conf);

you need to enable optionally the client certs and the tell the library
to not verify the certs.

I don't know how to help you in PHP, but I hope this can help a bit :)

[0]: <A HREF="https://github.com/omar-polo/gmid">https://github.com/omar-polo/gmid</A>
[1]: <A HREF="https://github.com/omar-polo/gmid/blob/master/gmid.c#L1076-L1078">https://github.com/omar-polo/gmid/blob/master/gmid.c#L1076-L1078</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004197.html">Supporting TLS client certificate in PHP?
</A></li>
	<LI>Next message (by thread): <A HREF="004206.html">Supporting TLS client certificate in PHP?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4204">[ date ]</a>
              <a href="thread.html#4204">[ thread ]</a>
              <a href="subject.html#4204">[ subject ]</a>
              <a href="author.html#4204">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.orbitalfox.eu/listinfo/gemini">More information about the Gemini
mailing list</a><br>
</body></html>
