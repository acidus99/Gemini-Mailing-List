<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Adding close_notify to the spec ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20Adding%20close_notify%20to%20the%20spec%20%3F&In-Reply-To=%3CCAFTy05YR99pc6Z%3D%2BEeOZhMqoGbC_KMOa8a6A8wt6PVH4oDuNLw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003136.html">
   <LINK REL="Next"  HREF="003275.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Adding close_notify to the spec ?</H1>
    <B>Michael Lazar</B> 
    <A HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20Adding%20close_notify%20to%20the%20spec%20%3F&In-Reply-To=%3CCAFTy05YR99pc6Z%3D%2BEeOZhMqoGbC_KMOa8a6A8wt6PVH4oDuNLw%40mail.gmail.com%3E"
       TITLE="Adding close_notify to the spec ?">lazar.michael22 at gmail.com
       </A><BR>
    <I>Wed Nov 11 02:39:58 GMT 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="003136.html">Adding close_notify to the spec ?
</A></li>
        <LI>Next message (by thread): <A HREF="003275.html">Adding close_notify to the spec ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3261">[ date ]</a>
              <a href="thread.html#3261">[ thread ]</a>
              <a href="subject.html#3261">[ subject ]</a>
              <a href="author.html#3261">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, Nov 7, 2020 at 8:19 PM Scot &lt;<A HREF="https://lists.orbitalfox.eu/listinfo/gemini">gmi1 at scotdoyle.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Does anyone have any concerns about amending the spec to state that a TLS
</I>&gt;<i> close_notify message should be sent before closing the TCP connection?
</I>&gt;<i> While TLS guarantees the integrity of the data from the server, it does
</I>&gt;<i> not guarantee completeness until a close_notify is received by the client.
</I>&gt;<i> Interested and able clients could then determine that they received a
</I>&gt;<i> complete response.
</I>&gt;<i>
</I>&gt;<i> The sending of close_notify is discussed in section 6.1 of RFC 8446 [1].
</I>&gt;<i>
</I>&gt;<i> This approach was previously discussed on the list by Michael Lazar and
</I>&gt;<i> solderpunk [2] [3] and kooda [4].
</I>&gt;<i>
</I>&gt;<i> &lt;snip&gt;
</I>&gt;<i>
</I>&gt;<i> You can inspect the TLS messages received from any server, including
</I>&gt;<i> the close_notify message, with the included Python script [6].
</I>&gt;<i>
</I>&gt;<i> 130 out of 208 servers listed on GUS [5] send the close_notify
</I>&gt;<i> message before disconnecting.
</I>
Thank you so much for this fantastic writeup! I agree with your conclusion
that close_notify should be explicitly called out in the gemini spec,
particularly in the transaction diagram under section 1.1.

I don't fault server authors for not implementing this correctly. If anything,
it just goes to show that TLS libraries are almost universally crappy and
unintuitive. We can't expect newcomers to gemini, many of whom are writing
their first server or trying out a new language, to know the inner workings of
TLS.

I took your code snippet and added to my gemini portal at <A HREF="https://portal.mozz.us">https://portal.mozz.us</A>
Now anyone can view their TLS connection details, including if the `send_alert`
message was sent, by clicking on the [view cert] link at the top of the page.
Hopefully this helps out as a quick way to test connections.

- mozz
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="003136.html">Adding close_notify to the spec ?
</A></li>
	<LI>Next message (by thread): <A HREF="003275.html">Adding close_notify to the spec ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3261">[ date ]</a>
              <a href="thread.html#3261">[ thread ]</a>
              <a href="subject.html#3261">[ subject ]</a>
              <a href="author.html#3261">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.orbitalfox.eu/listinfo/gemini">More information about the Gemini
mailing list</a><br>
</body></html>
