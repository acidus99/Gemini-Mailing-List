<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> SRV records
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20SRV%20records&In-Reply-To=%3C20200628025552.GP19717%40brevard.conman.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001993.html">
   <LINK REL="Next"  HREF="001995.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>SRV records</H1>
    <B>Sean Conner</B> 
    <A HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20SRV%20records&In-Reply-To=%3C20200628025552.GP19717%40brevard.conman.org%3E"
       TITLE="SRV records">sean at conman.org
       </A><BR>
    <I>Sun Jun 28 03:55:52 BST 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="001993.html">SRV records
</A></li>
        <LI>Next message (by thread): <A HREF="001995.html">SRV records
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1994">[ date ]</a>
              <a href="thread.html#1994">[ thread ]</a>
              <a href="subject.html#1994">[ subject ]</a>
              <a href="author.html#1994">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It was thus said that the Great Evert Pot once stated:
&gt;<i> Dear list,
</I>&gt;<i> 
</I>&gt;<i> I would like to play around with Gemini and build a personal site. I'd
</I>&gt;<i> love to be able to host it on my main domain at <A HREF="gemini://evertpot.com/">gemini://evertpot.com/</A>
</I>
  Okay, so you are running a service on port 1965 that *isn't* Gemini, and
you would like to run a Gemini server on a different port, but not have to
specify the port number on the URL.  Okay, got it.

&gt;<i> It occurred to me that it would be nice if I could use DNS SRV records
</I>&gt;<i> to point <A HREF="gemini://">gemini://</A> clients to a different host. However, after reading
</I>&gt;<i> the spec it doesn't seem like there is support for this.
</I>&gt;<i> 
</I>&gt;<i> I would love support for this, but or that to be realistically useful,
</I>&gt;<i> it would have to be in the spec and required. I know a lot of HTTP folks
</I>&gt;<i> wish they had that from the start too, as it's a pain to adopt later.
</I>
  Like you, I wouldn't mind seeing SRV records used more often, but there
are considerations.  First off, the dismal state of DNS resolution libaries
out there.  For the most part, they pretty much do too much (have their own
network driver that is hard to integrate into an existing network based
program) and do too little (very little support for non A/AAAA records---you
might get lucky and get MX support).

  I was fed up enough to write my own DNS encoding/decoding library [1] but
that only helps if you use C (or Lua---I include Lua bindings in the
library) and you still need to integrate your own networking with it [3].

  Second, the code needs to be aware that multiple SRV records for a given
service can exist, and how to order the results and pick one.

  And the use of SRV records impact clients more than servers.  Instead of
now, where a client can go:

	location = breakdown(url)
	address = getaddrinfo(location.host,location.port or 1965)

you now need:

	results = lookup(RR_SRV,location.host)
	if results then
		sort(results) /* based upon priority and weight */
				/* if not done by the lookup() routine */
		for each result in results do
		  address = getaddrinfo(result.host,result.port)
		  if address then break
		end
	end
	if not address then
		address = getaddrinfo(location.host,location.port or 1965)
	end

  Keep in mind the above is &quot;get the idea&quot; pseudocode, not real code.

&gt;<i> I couldn't find in the archives if this has been asked before.
</I>
  It has not.

  -spc (The client now needs to know which DNS server to query, and how does
	it obtain *that* information?)

[1]	<A HREF="https://github.com/spc476/SPCDNS">https://github.com/spc476/SPCDNS</A> [2]

[2]	My most popular Github project if going by stars.

[3]	A lot easier than with the other DNS libraries I've come across, but
	it still needs to be done.
</PRE>















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="001993.html">SRV records
</A></li>
	<LI>Next message (by thread): <A HREF="001995.html">SRV records
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1994">[ date ]</a>
              <a href="thread.html#1994">[ thread ]</a>
              <a href="subject.html#1994">[ subject ]</a>
              <a href="author.html#1994">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.orbitalfox.eu/listinfo/gemini">More information about the Gemini
mailing list</a><br>
</body></html>
