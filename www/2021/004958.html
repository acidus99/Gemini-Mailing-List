<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [spec] The Tragedy of &amp;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20%5Bspec%5D%20The%20Tragedy%20of%20%26&In-Reply-To=%3CCAObwWNj%3D45AcLCTEcNbNjEQqQKyr8i3R61AXQkRLkRj3pM1LXQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004947.html">
   <LINK REL="Next"  HREF="004964.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[spec] The Tragedy of &amp;</H1>
    <B>Katarina Eriksson</B> 
    <A HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20%5Bspec%5D%20The%20Tragedy%20of%20%26&In-Reply-To=%3CCAObwWNj%3D45AcLCTEcNbNjEQqQKyr8i3R61AXQkRLkRj3pM1LXQ%40mail.gmail.com%3E"
       TITLE="[spec] The Tragedy of &amp;">gmym at coopdot.com
       </A><BR>
    <I>Fri Jan 29 12:05:31 GMT 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004947.html">[spec] The Tragedy of &amp;
</A></li>
        <LI>Next message (by thread): <A HREF="004964.html">[spec] The Tragedy of &amp;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4958">[ date ]</a>
              <a href="thread.html#4958">[ thread ]</a>
              <a href="subject.html#4958">[ subject ]</a>
              <a href="author.html#4958">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Gary Johnson &lt;<A HREF="https://lists.orbitalfox.eu/listinfo/gemini">lambdatronic at disroot.org</A>&gt; wrote

&gt;<i> =&gt; form?$SESSION&amp;name Name: $NAME
</I>&gt;<i>
</I>&gt;<i> =&gt; form?$SESSION&amp;password Password: $PASSWORD
</I>&gt;<i>
</I>&gt;<i> =&gt; form?$SESSION&amp;smog SMOG is great: $SMOG
</I>&gt;<i>
</I>&gt;<i> =&gt; form?$SESSION&amp;plant Best Astrobotany Plant: $PLANT
</I>&gt;<i>
</I>&gt;<i> =&gt; form?$SESSION&amp;submit Submit Answers
</I>&gt;<i>
</I>
[...]

(Obviously, a more robust state management mechanism could be achieved
&gt;<i> with client certs and a DB, but I just mean to show a very simple
</I>&gt;<i> example here.)
</I>&gt;<i>
</I>
Yes, if the client supports client certificates, we can skip sending
$SESSION and use the regular inputs:

```text/gemini list of links
=&gt; <A HREF="gemini://awesome.capsule.net/form/name">gemini://awesome.capsule.net/form/name</A> Name
=&gt; <A HREF="gemini://awesome.capsule.net/form/password">gemini://awesome.capsule.net/form/password</A> Password
=&gt; <A HREF="gemini://awesome.capsule.net/form/smog">gemini://awesome.capsule.net/form/smog</A> SMOG is great
=&gt; <A HREF="gemini://awesome.capsule.net/form/plant">gemini://awesome.capsule.net/form/plant</A> Best Astrobotany Plant
=&gt; <A HREF="gemini://awesome.capsule.net/form/submit">gemini://awesome.capsule.net/form/submit</A> Submit Answers
```

[...]

## Section 3.3: (DESIRED) Client-side Requests
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The intention of this example is that the clients would produce requests
</I>&gt;<i> of this form after each input prompt:
</I>&gt;<i>
</I>&gt;<i> =&gt; <A HREF="gemini://awesome.capsule.net/form?$SESSION&amp;name&amp;Gary%20Johnson">gemini://awesome.capsule.net/form?$SESSION&amp;name&amp;Gary%20Johnson</A>
</I>&gt;<i> =&gt; <A HREF="gemini://awesome.capsule.net/form?$SESSION&amp;password&amp;secret">gemini://awesome.capsule.net/form?$SESSION&amp;password&amp;secret</A>
</I>&gt;<i> =&gt; <A HREF="gemini://awesome.capsule.net/form?$SESSION&amp;smog&amp;yes">gemini://awesome.capsule.net/form?$SESSION&amp;smog&amp;yes</A>
</I>&gt;<i> =&gt; <A HREF="gemini://awesome.capsule.net/form?$SESSION&amp;plant&amp;Ficus">gemini://awesome.capsule.net/form?$SESSION&amp;plant&amp;Ficus</A>
</I>&gt;<i>
</I>&gt;<i> where $SESSION is whatever value was generated by the CGI script on the
</I>&gt;<i> first page load.
</I>&gt;<i>
</I>
I do not understand this example.

When using regular inputs, the client will send these requests:

<A HREF="gemini://awesome.capsule.net/form/name?Gary%Johnson">gemini://awesome.capsule.net/form/name?Gary%Johnson</A>
<A HREF="gemini://awesome.capsule.net/form/password?secret">gemini://awesome.capsule.net/form/password?secret</A>
<A HREF="gemini://awesome.capsule.net/form/smog?yes">gemini://awesome.capsule.net/form/smog?yes</A>
<A HREF="gemini://awesome.capsule.net/form/plant?Ficus">gemini://awesome.capsule.net/form/plant?Ficus</A>
<A HREF="gemini://awesome.capsule.net/form/submit">gemini://awesome.capsule.net/form/submit</A>

(No &quot;?&quot; on &quot;submit&quot; since it's just telling the server that we're done.)

What is the benefit of doing it your way?

## Section 3.4: Server-side State Management and Form Submission
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> With this information in the query params, it would be easy to store a
</I>&gt;<i> lookup table in the CGI script that mapped session -&gt; field -&gt; value,
</I>&gt;<i> and these values can then be easily inserted into the original Gemtext
</I>&gt;<i> template form above (see Section 3.1) in response to these requests.
</I>&gt;<i>
</I>
If you format the URLs like this:

<A HREF="gemini://$HOST/path/to/script/$FIELD?$VALUE">gemini://$HOST/path/to/script/$FIELD?$VALUE</A>

...then $FIELD should show up as PATH_INFO (probably with a leading &quot;/&quot;)
and $VALUE as QUERY_STRING.

[...]

 The only problem I'm running into here is that the various Gemini

clients I've tested (elpher, bombadillo, kristall) don't actually append
&gt;<i> a user's input as an additional parameter to an existing query string if
</I>&gt;<i> one is present. Instead, bombadillo and kristall just overwrite the
</I>&gt;<i> existing query string and only return ?$NEW_INPUT. Elpher, on the other
</I>&gt;<i> hand, just creates invalid URLs by simply appending ?$NEW_INPUT to
</I>&gt;<i> whatever is already in the URL (e.g.,
</I>&gt;<i> <A HREF="gemini://awesome.capsule.net/form?$SESSION&amp;smog?yes.">gemini://awesome.capsule.net/form?$SESSION&amp;smog?yes.</A> Neither of these
</I>&gt;<i> behaviors do what I'd want or expect here.
</I>&gt;<i>
</I>
Elpher is doing something weird here but the others are handling inputs as
intended.

## Section 4.1: Check the Spec!
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I think the culprit then is probably Gemini Protocol Specification
</I>&gt;<i> section 3.2.1 1x (INPUT):
</I>&gt;<i>
</I>
[...]

&gt;<i>
</I>## Section 4.2: Append Don't Replace!
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> As far as I can tell, the fix here is for Solderpunk to update the text
</I>&gt;<i> in section 3.2.1 to indicate that if a query string is already part of
</I>&gt;<i> the request leading to an INPUT response, then the user's input should
</I>&gt;<i> be appended (using &amp;) to the existing query string rather than replacing
</I>&gt;<i> it wholesale (using ?).
</I>&gt;<i>
</I>
This is not a necessary spec change.

Otherwise, we really have no way to input more than one query param
&gt;<i> (with &amp;) other than asking the user to type it directly into the INPUT
</I>&gt;<i> prompt (e.g., cat&amp;dog&amp;pig).
</I>

The responsibility for collecting parameters fall on the server, not on the
client. The only thing the client needs to do is sending one query for each
field.

I'm hoping this isn't the spec's intention
&gt;<i> here and that we just have a case of ambiguous wording that has led some
</I>&gt;<i> client authors to create divergent (or broken) implementations
</I>&gt;<i>
</I>
Sorry to disappoint you. I suggest leaving the ampersands to the web
queries.

[...]

I've attached a short (47 line) CGI script (for Space Age) that
&gt;<i> implements the dynamic form example described in this email.
</I>&gt;<i>
</I>
Thank you for providing example code and I'm sorry for not doing the same.

-- 
Katarina

&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.orbitalfox.eu/archives/gemini/attachments/20210129/c5136798/attachment.htm">https://lists.orbitalfox.eu/archives/gemini/attachments/20210129/c5136798/attachment.htm</A>&gt;
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004947.html">[spec] The Tragedy of &amp;
</A></li>
	<LI>Next message (by thread): <A HREF="004964.html">[spec] The Tragedy of &amp;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4958">[ date ]</a>
              <a href="thread.html#4958">[ thread ]</a>
              <a href="subject.html#4958">[ subject ]</a>
              <a href="author.html#4958">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.orbitalfox.eu/listinfo/gemini">More information about the Gemini
mailing list</a><br>
</body></html>
