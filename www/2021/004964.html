<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [spec] The Tragedy of &amp;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20%5Bspec%5D%20The%20Tragedy%20of%20%26&In-Reply-To=%3C87zh0qb0xc.fsf%40disroot.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004958.html">
   <LINK REL="Next"  HREF="004965.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[spec] The Tragedy of &amp;</H1>
    <B>Gary Johnson</B> 
    <A HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20%5Bspec%5D%20The%20Tragedy%20of%20%26&In-Reply-To=%3C87zh0qb0xc.fsf%40disroot.org%3E"
       TITLE="[spec] The Tragedy of &amp;">lambdatronic at disroot.org
       </A><BR>
    <I>Sat Jan 30 20:54:39 GMT 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="004958.html">[spec] The Tragedy of &amp;
</A></li>
        <LI>Next message (by thread): <A HREF="004965.html">[spec] The Tragedy of &amp;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4964">[ date ]</a>
              <a href="thread.html#4964">[ thread ]</a>
              <a href="subject.html#4964">[ subject ]</a>
              <a href="author.html#4964">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> ## Section 3.3: (DESIRED) Client-side Requests
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The intention of this example is that the clients would produce requests
</I>&gt;&gt;<i> of this form after each input prompt:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> =&gt; <A HREF="gemini://awesome.capsule.net/form?$SESSION&amp;name&amp;Gary%20Johnson">gemini://awesome.capsule.net/form?$SESSION&amp;name&amp;Gary%20Johnson</A>
</I>&gt;&gt;<i> =&gt; <A HREF="gemini://awesome.capsule.net/form?$SESSION&amp;password&amp;secret">gemini://awesome.capsule.net/form?$SESSION&amp;password&amp;secret</A>
</I>&gt;&gt;<i> =&gt; <A HREF="gemini://awesome.capsule.net/form?$SESSION&amp;smog&amp;yes">gemini://awesome.capsule.net/form?$SESSION&amp;smog&amp;yes</A>
</I>&gt;&gt;<i> =&gt; <A HREF="gemini://awesome.capsule.net/form?$SESSION&amp;plant&amp;Ficus">gemini://awesome.capsule.net/form?$SESSION&amp;plant&amp;Ficus</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> where $SESSION is whatever value was generated by the CGI script on the
</I>&gt;&gt;<i> first page load.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I do not understand this example.
</I>&gt;<i>
</I>&gt;<i> When using regular inputs, the client will send these requests:
</I>&gt;<i>
</I>&gt;<i> <A HREF="gemini://awesome.capsule.net/form/name?Gary%Johnson">gemini://awesome.capsule.net/form/name?Gary%Johnson</A>
</I>&gt;<i> <A HREF="gemini://awesome.capsule.net/form/password?secret">gemini://awesome.capsule.net/form/password?secret</A>
</I>&gt;<i> <A HREF="gemini://awesome.capsule.net/form/smog?yes">gemini://awesome.capsule.net/form/smog?yes</A>
</I>&gt;<i> <A HREF="gemini://awesome.capsule.net/form/plant?Ficus">gemini://awesome.capsule.net/form/plant?Ficus</A>
</I>&gt;<i> <A HREF="gemini://awesome.capsule.net/form/submit">gemini://awesome.capsule.net/form/submit</A>
</I>&gt;<i>
</I>&gt;<i> (No &quot;?&quot; on &quot;submit&quot; since it's just telling the server that we're done.)
</I>&gt;<i>
</I>&gt;<i> What is the benefit of doing it your way?
</I>
Hi Katarina,

  Thanks for taking the time to reply to my message. I'll try to clarify
my point here.

The issue I'm raising is that there appears to be no way to pass more
than one piece of information at a time in our query strings. This has a
very significant impact on any writers of CGI scripts, which is how many
Gemini servers allow users to add dynamic pages to their capsules.

But why, you ask?

Because each CGI script is available at a particular file path and
therefore additional path segments can't be used to pass information to
them. They have to get their inputs from the query string.

This is a script. It probably returns a 20 response:

=&gt; <A HREF="gemini://awesome.capsule.net/form.clj">gemini://awesome.capsule.net/form.clj</A>

If I want to fill in a name field on that page, I might provide a link
like this:

=&gt; <A HREF="gemini://awesome.capsule.net/form.clj?name">gemini://awesome.capsule.net/form.clj?name</A>

This calls the CGI script with a query parameter. Great! The script can
use &quot;name&quot; to look up the appropriate response. Here it is:

10 Please enter your name\r\n

However, when the user fills in their name, the browser will now send
this request to the server:

=&gt; <A HREF="gemini://awesome.capsule.net/form.clj?Gary%20Johnson">gemini://awesome.capsule.net/form.clj?Gary%20Johnson</A>

There is no way for the CGI script to know that this is a name value and
not the value for any other form field on the page.

And therein lies the rub. If the only way to associate input values with
the variables they represent is with path segments, then CGI scripts
simply can't ever use more than one input field per page. Even then, if
the query string used to trigger a 10 INPUT response is typed by the
user (into the totally free form text field they are presented), then
the server will continue to respond with yet another 10 INPUT response.

This would make a form with N fields require N+1 separate CGI scripts,
all chained together via links that represent the directory structure
into which they are installed.

This is an absolute nightmare scenario for programming anything that
wants to accept user inputs.

So what does this mean for Geminispace?

It means essentially that CGI scripts are currently second-class
citizens, and the only people who can write dynamic capsules are server
authors (or people willing to hack on server code). This is because
encoding information using path segments requires injecting custom
routing table code into the server's request handler.

As a server author, I am capable of creating a custom fork of my server
with a new routing table for each dynamic capsule I want to build.
However, I suspect the majority of Gemini users are not going to have
both the skill and willingness to engage in this level of coding on
their pages.

That is why I and many other authors have added support for CGI scripts
to our servers. But under the &quot;only one piece of information in the
query string&quot; paradigm, these scripts are currently rather handicapped
when it comes to accepting user input.

Hopefully, I've made the technical merits of my case clear here.


&gt;<i> ## Section 4.2: Append Don't Replace!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> As far as I can tell, the fix here is for Solderpunk to update the text
</I>&gt;&gt;<i> in section 3.2.1 to indicate that if a query string is already part of
</I>&gt;&gt;<i> the request leading to an INPUT response, then the user's input should
</I>&gt;&gt;<i> be appended (using &amp;) to the existing query string rather than replacing
</I>&gt;&gt;<i> it wholesale (using ?).
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This is not a necessary spec change.
</I>

Yes, it really is if anyone other than server authors is ever going to
be able to write their own dynamic pages.


&gt;<i> Otherwise, we really have no way to input more than one query param
</I>&gt;&gt;<i> (with &amp;) other than asking the user to type it directly into the INPUT
</I>&gt;&gt;<i> prompt (e.g., cat&amp;dog&amp;pig).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The responsibility for collecting parameters fall on the server, not on the
</I>&gt;<i> client. The only thing the client needs to do is sending one query for each
</I>&gt;<i> field.
</I>

Again, see above. A single query value cannot be associated with its
variable without adding a custom routing table to the server to enable
the parsing of path segment data as additional inputs.


&gt;<i> I'm hoping this isn't the spec's intention
</I>&gt;&gt;<i> here and that we just have a case of ambiguous wording that has led some
</I>&gt;&gt;<i> client authors to create divergent (or broken) implementations
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Sorry to disappoint you. I suggest leaving the ampersands to the web
</I>&gt;<i> queries.
</I>

I'm afraid we disagree here.


&gt;<i> Thank you for providing example code and I'm sorry for not doing the same.
</I>

If you can write a CGI script that can correctly associate INPUT
responses with their intended variables, please share it. I suspect it
would be quite educational.

Happy hacking,
  Gary

-- 
GPG Key ID: 7BC158ED
Use `gpg --search-keys lambdatronic' to find me
Protect yourself from surveillance: <A HREF="https://emailselfdefense.fsf.org">https://emailselfdefense.fsf.org</A>
=======================================================================
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments

Why is HTML email a security nightmare? See <A HREF="https://useplaintext.email/">https://useplaintext.email/</A>

Please avoid sending me MS-Office attachments.
See <A HREF="http://www.gnu.org/philosophy/no-word-attachments.html">http://www.gnu.org/philosophy/no-word-attachments.html</A>
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="004958.html">[spec] The Tragedy of &amp;
</A></li>
	<LI>Next message (by thread): <A HREF="004965.html">[spec] The Tragedy of &amp;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4964">[ date ]</a>
              <a href="thread.html#4964">[ thread ]</a>
              <a href="subject.html#4964">[ subject ]</a>
              <a href="author.html#4964">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.orbitalfox.eu/listinfo/gemini">More information about the Gemini
mailing list</a><br>
</body></html>
