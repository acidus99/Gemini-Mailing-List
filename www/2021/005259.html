<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Molly Brown Certificate Zone Help
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20Molly%20Brown%20Certificate%20Zone%20Help&In-Reply-To=%3CCAHvN2xz%2Bb%2B0ARSiQLwjfQXa9A0yP85h25Tyw8aTn-UM4dHLUAg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005225.html">
   <LINK REL="Next"  HREF="005292.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Molly Brown Certificate Zone Help</H1>
    <B>Lindsay</B> 
    <A HREF="mailto:gemini%40lists.orbitalfox.eu?Subject=Re%3A%20Molly%20Brown%20Certificate%20Zone%20Help&In-Reply-To=%3CCAHvN2xz%2Bb%2B0ARSiQLwjfQXa9A0yP85h25Tyw8aTn-UM4dHLUAg%40mail.gmail.com%3E"
       TITLE="Molly Brown Certificate Zone Help">newsspeak11 at gmail.com
       </A><BR>
    <I>Mon Feb 15 00:03:56 GMT 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="005225.html">Molly Brown Certificate Zone Help
</A></li>
        <LI>Next message (by thread): <A HREF="005292.html">Molly Brown Certificate Zone Help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5259">[ date ]</a>
              <a href="thread.html#5259">[ thread ]</a>
              <a href="subject.html#5259">[ subject ]</a>
              <a href="author.html#5259">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>After some additional reading and trial and error, I think I've made
progress, but still not successful.

I've now created a client key and a signed client certificate and added
them both to Kristall's certificate manager. I've also managed to generate
what I believe is a proper SHA256 has using this command on my client
certificate: openssl dgst -sha256

I believe this is a proper hash as it matches the style and length of the
examples proved in the molly.conf file. I've also verified that the
fingerprint of the key pair in Kristall matches the fingerprint of the
client certificate I used to generate the SHA256 hash.

The Certificate Zone area of the config file now looks something like this:

&gt;<i> [CertificateZones]
</I>&gt;<i> &quot;^/foo/&quot; = [
</I>&gt;<i>     &quot;d146953386694266175d10be3617427dfbeb751d1805d36b3c7aedd9de02d9af&quot;
</I>&gt;<i>
</I>&gt;<i> ]
</I>&gt;<i>
</I>
Now that I have a certificate value that looks to be correct, I'm not sure
what else to try. Are there any verbose logs available that I can enable to
see what is being passed to Molly Brown or how the certificates are being
compared?

On Sat, Feb 13, 2021 at 7:31 PM Lindsay &lt;<A HREF="https://lists.orbitalfox.eu/listinfo/gemini">newsspeak11 at gmail.com</A>&gt; wrote:

&gt;<i> Greetings all,
</I>&gt;<i>
</I>&gt;<i> I am trying to set up a server using Molly Brown and am having trouble
</I>&gt;<i> implementing its &quot;Certificate Zone&quot; feature. If this isn't the correct
</I>&gt;<i> forum for this question, please let me know.
</I>&gt;<i>
</I>&gt;<i> So far, I've set a directory require a certificate and successfully tested
</I>&gt;<i> it - I am free to access all areas on the site and receive a certificate
</I>&gt;<i> challenge to the one directory as configured.
</I>&gt;<i>
</I>&gt;<i> The problem I'm having is understanding how to add a specific client
</I>&gt;<i> fingerprint to the &quot;allowed&quot; list in the config file. The Molly Brown
</I>&gt;<i> documentation specify an allowed value takes the format of &quot;hex-encoded
</I>&gt;<i> SHA256 fingerprints of client certificates&quot;. I have what I think is a valid
</I>&gt;<i> fingerprint that I then converted into hex added to this section (which is
</I>&gt;<i> significantly longer than any of the examples provided), but the
</I>&gt;<i> corresponding certificate is rejected when provided.
</I>&gt;<i>
</I>&gt;<i> I am certain this is user error. I have very little knowledge on how to
</I>&gt;<i> manage certificates and rely on google searches when generated the correct
</I>&gt;<i> ones for this server. Assuming the values provided in the example config
</I>&gt;<i> file are based on real, working values, my value is nearly 4 times as long.
</I>&gt;<i>
</I>&gt;<i> Here's what I did:
</I>&gt;<i> 1. Generate a new key with following command:
</I>&gt;<i>
</I>&gt;&gt;<i> openssl req -new -newkey rsa:4096 -x509 -sha256 -days 3650 -nodes -out
</I>&gt;&gt;<i> cert.crt -keyout key.key
</I>&gt;&gt;<i>
</I>&gt;<i> 2. Changed extension on output keys to .pem as required by Kristall Browser
</I>&gt;<i> 3. Imported ley and cer into Kristall
</I>&gt;<i> 4. Converted the fingerprint of the cert into hexadecimal with the
</I>&gt;<i> following command:
</I>&gt;<i>
</I>&gt;&gt;<i> echo -n &quot;[Fingerprint went here]&quot; | od -A n -t x1
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 5. Copied hexadecimal value into Molly Brown configuration file so the section looks like this:
</I>&gt;<i>
</I>&gt;<i> [CertificateZones]
</I>&gt;<i>
</I>&gt;<i> &quot;^/foo/&quot; = [
</I>&gt;&gt;<i> #
</I>&gt;&gt;<i>       &quot;d146953386694266175d10be3617427dfbeb751d1805d36b3c7aedd9de02d9af&quot;,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &quot;aa1ee9e5a1572a4677e9f59e181b5c6a27527c7602bd441e7bf909f681db2eb36c32246c5193a270fcfbc509fef9349b03d6a299907580c90566c881752a01adcd9055fae1e53a308c56020462849b42ab777d67c9c5e3fd0427ec6d42a997&quot;,
</I>&gt;&gt;<i> ]
</I>&gt;&gt;<i>
</I>&gt;<i> 6. Relaunch Molly Brown
</I>&gt;<i>
</I>&gt;<i> Apologies if this is an elementary problem or the incorrect forum for such a question and appreciate any help that is provided.
</I>&gt;<i>
</I>&gt;<i> Tanks!
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.orbitalfox.eu/archives/gemini/attachments/20210214/4562044e/attachment.htm">https://lists.orbitalfox.eu/archives/gemini/attachments/20210214/4562044e/attachment.htm</A>&gt;
</PRE>






















































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="005225.html">Molly Brown Certificate Zone Help
</A></li>
	<LI>Next message (by thread): <A HREF="005292.html">Molly Brown Certificate Zone Help
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5259">[ date ]</a>
              <a href="thread.html#5259">[ thread ]</a>
              <a href="subject.html#5259">[ subject ]</a>
              <a href="author.html#5259">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.orbitalfox.eu/listinfo/gemini">More information about the Gemini
mailing list</a><br>
</body></html>
